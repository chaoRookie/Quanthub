# QuantHub 数据库管理指南

## 使用 Django Admin 可视化管理数据库

### 1. 创建管理员账号

```bash
python manage.py createsuperuser
```

按提示输入用户名、邮箱和密码。

### 2. 启动开发服务器

```bash
python manage.py runserver
```

### 3. 访问管理后台

打开浏览器访问: `http://127.0.0.1:8000/admin/`

使用刚才创建的管理员账号登录。

### 4. 功能介绍

在管理后台你可以：

- **查看所有数据表**: 用户、行情、策略、版本、回测结果
- **搜索和过滤**: 按日期、股票代码、用户等条件筛选
- **查看统计信息**: 每个策略有多少个版本、回测结果等
- **数据导出**: 可以导出为 CSV 格式
- **安全保护**: 历史行情数据设置为只读，防止误删除

### 5. 亮点功能

- 📊 **回测结果颜色标记**: 盈利显示绿色，亏损显示红色
- 🔍 **智能搜索**: 支持按策略名称、股票代码搜索
- 📅 **日期导航**: 点击年份快速查看某一年的数据
- 📝 **代码预览**: 在列表中直接预览策略代码

---

## 代码改进说明

### 改进 1: `data_loader.py` 安全性提升

**改进前**: Token 硬编码在代码里
```python
TUSHARE_TOKEN = "YOUR_TUSHARE_TOKEN_HERE"
```

**改进后**: 从环境变量读取
```python
TUSHARE_TOKEN = os.environ.get('TUSHARE_TOKEN', '')
```

**使用方法**:
```bash
# Windows
set TUSHARE_TOKEN=你的token
python manage.py shell

# Linux/Mac
export TUSHARE_TOKEN=你的token
python manage.py shell
```

这样可以避免把 Token 提交到 Git。

### 改进 2: `settings.py` 完整配置

添加了 Django Admin 所需的所有配置：
- 中文界面 (`LANGUAGE_CODE = 'zh-hans'`)
- 上海时区 (`TIME_ZONE = 'Asia/Shanghai'`)
- Admin 应用已启用

### 改进 3: 更友好的 Admin 界面

- 为每个模型添加了自定义显示字段
- 添加了搜索、过滤、排序功能
- 历史数据设置为只读，防止误操作
- 自定义了中文标题和图标

---

## 下一步建议

1. **安全性**: 在生产环境记得修改 `SECRET_KEY`
2. **性能**: 如果数据量超过百万级，考虑添加数据库索引优化
3. **备份**: 定期备份 PostgreSQL 数据库

有问题随时找我！
